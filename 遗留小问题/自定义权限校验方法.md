---
up:
  - "[[SpringSecurity 課程描述]]"
---
我们也可以定义自己的权限校验方法，在 @PreAuthorize 注解中使用我们的方法。

```java
@Component("ex")
public class SGExpressionRoot {

    public boolean hasAuthority(String authority){
        //获取当前用户的权限
        Authentication authentication = SecurityContextHolder.getContext().getAuthentication();
        LoginUser loginUser = (LoginUser) authentication.getPrincipal();
        List<String> permissions = loginUser.getPermissions();
        //判断用户权限集合中是否存在authority
        return permissions.contains(authority);
    }
}
```

在 SPEL 表达式中使用 @ex 相当于获取容器中 bean 的名字未ex的对象。然后再调用这个对象的 hasAuthority 方法

```java
@RequestMapping("/hello")
@PreAuthorize("@ex.hasAuthority('system:dept::list')")
public String hello(){
	return "hello";
}
```